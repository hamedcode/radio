<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ø±Ø§Ø¯ÛŒÙˆ Ø¢Ù†Ù„Ø§ÛŒÙ†</title>

  <style>
    :root{
      --bg:#121212;
      --card:#1d1d1d;
      --accent:#00ffa6;
      --text:#eee;
    }
    body{
      margin:0;
      font-family:sans-serif;
      direction:rtl;
      background:var(--bg);
      color:var(--text);
    }

    .header{
      padding:18px;
      text-align:center;
      background:#151515;
      font-size:22px;
    }

    /* columns */
    .cols{
      display:flex;
      gap:18px;
      padding:16px;
      box-sizing:border-box;
    }
    .col{
      flex:1;
      background:transparent;
    }
    .category{
      padding:10px 14px;
      font-size:18px;
      background:#212121;
      border-radius:8px;
      margin-bottom:10px;
    }

    .station-list{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .station{
      display:flex;
      align-items:center;
      justify-content:space-between;
      background:var(--card);
      padding:10px;
      border-radius:10px;
      cursor:pointer;
    }
    .station:hover{ background:#2a2a2a; }

    .left{ display:flex; align-items:center; gap:10px; }
    .station img{ width:44px; height:44px; border-radius:6px; object-fit:cover; }

    .station button{
      background:var(--accent);
      border:none;
      color:#000;
      padding:8px 10px;
      border-radius:8px;
      cursor:pointer;
    }

    /* unified player box */
    .player-wrap{
      position:fixed;
      bottom:0;
      left:0;
      right:0;
      background:#181818;
      border-top:3px solid var(--accent);
      z-index:1000;
    }

    /* equalizer */
    #eq{
      width:100%;
      height:64px;
      display:block;
      background:#000;
    }

    /* player row */
    .player-box{
      padding:10px 14px;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .player-title{ flex:1; font-size:16px; }
    .vol{ width:140px; }

    @media(max-width:800px){
      .cols{ flex-direction:column; }
    }
  </style>
</head>

<body>

<div class="header">ğŸ§ Ø±Ø§Ø¯ÛŒÙˆ Ø¢Ù†Ù„Ø§ÛŒÙ†</div>

<div class="cols">

  <!-- Azeri/Turk -->
  <div class="col">
    <div class="category">ğŸ“Œ ØªØ±Ú©ÛŒ Ùˆ Ø¢Ø°Ø±ÛŒ</div>
    <div class="station-list" id="cat_tr"></div>
  </div>

  <!-- Persian -->
  <div class="col">
    <div class="category">ğŸ“Œ ÙØ§Ø±Ø³ÛŒ</div>
    <div class="station-list" id="cat_fa"></div>
  </div>

</div>

<!-- unified player + EQ -->
<div class="player-wrap">
  <canvas id="eq"></canvas>
  <div class="player-box">
    <div id="nowPlaying" class="player-title">Ù‡ÛŒÚ† Ø±Ø§Ø¯ÛŒÙˆÛŒÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡</div>
    <div>Ø­Ø¬Ù…: <input type="range" id="volume" class="vol" min="0" max="1" step="0.01" value="1"></div>
    <button id="stopBtn">â¹ ØªÙˆÙ‚Ù</button>
  </div>
</div>

<script>
/* ====== STATIONS ====== */
const stations = [
  { name:"Radio Sedaye Khiaban", url:"https://stream-177.zeno.fm/1nyiz8ma60hvv", lang:"fa", logo:"" },
  { name:"Radio Shadi", url:"https://ice9.securenetsystems.net/SHADI", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/NRIGBcOzqWFUZZ4dhVZ3bp6oKMftJTpniyrmgru7dZM/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvOGUyZDcwMjUtMmZhMC00MDU5LWFmNGMtMDg0ZjA1NmZjOTk4L2ltYWdlLz91PTE3MDE2OTc1OTEwMDA.webp"
  },
  { name:"Radio Avang Klap", url:"https://stream.zeno.fm/fpabqr8pd9zuv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/acnY7ntKys9h-2AhQvRWpVDUV0WY3Kh-Jfb8rkjNuH4/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvNTBmMmVlYjAtNzVkOC00YTllLTlkNWYtZjY1YjkwYjk3MDQ2L2ltYWdlLz91PTE3MzY4NDYwMzEwMDA.webp"
  },
  { name:"Radio Bamdad", url:"https://stream.zeno.fm/16gxgv7ch5zuv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/RI7ZbLc36B1wt2hmlyMxSBwXpETbKBuvcd6coiCjGds/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlNZ3NTQ2tGMWRHaERiR2xsYm5RWWdJQ1FvLTdyMGdvTUN4SU9VM1JoZEdsdmJsQnliMlpwYkdVWWdJQ1E0OGEwaUFnTW9nRUVlbVZ1YncvaW1hZ2UvP3U9MTY2MDgzMzA4MjAwMA.webp"
  },

  { name:"Radio Veten", url:"https://stream.zeno.fm/0kgkkzanmueuv", lang:"tr",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/8g8PctmUYIp-MsAb60n1yzr6UB2mIagYYh9OFcI8AO4/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlNZ3NTQ2tGMWRHaERiR2xsYm5RWWdJREFwdENqdkFzTUN4SU9VM1JoZEdsdmJsQnliMlpwYkdVWWdJQ0FnSUR5aUFvTW9nRUVlbVZ1YncvaW1hZ2UvP3U9MTY3NDE5MDEyNzAwMA.webp"
  }
];

/* ELEMENTS */
const cat_fa = document.getElementById('cat_fa');
const cat_tr = document.getElementById('cat_tr');
const nowPlaying = document.getElementById('nowPlaying');
const volume = document.getElementById('volume');
const stopBtn = document.getElementById('stopBtn');

/* AUDIO */
const audio = new Audio();
audio.crossOrigin = "anonymous";
audio.volume = parseFloat(volume.value);

let currentStation=null, currentButton=null;

/* BUILD ITEMS */
function makeStationElement(st){
  const el = document.createElement('div');
  el.className='station';

  const left = document.createElement('div');
  left.className='left';

  if(st.logo){
    const img = document.createElement('img');
    img.src = st.logo;
    left.appendChild(img);
  }

  const meta = document.createElement('div');
  meta.textContent = st.name;
  left.appendChild(meta);

  const btn = document.createElement('button');
  btn.textContent='â–¶ Ù¾Ø®Ø´';
  btn.onclick=(e)=>{ e.stopPropagation(); playStation(st,btn); };

  el.appendChild(left);
  el.appendChild(btn);
  el.onclick=()=> playStation(st,btn);

  return el;
}

stations.forEach(s=>{
  const el = makeStationElement(s);
  if(s.lang==="fa") cat_fa.appendChild(el);
  else cat_tr.appendChild(el);
});

/* PLAY HANDLER */
function playStation(st,btn){
  if(currentStation && currentStation.url===st.url && !audio.paused){
    audio.pause();
    btn.textContent='â–¶ Ù¾Ø®Ø´';
    nowPlaying.textContent='Ù‡ÛŒÚ† Ø±Ø§Ø¯ÛŒÙˆÛŒÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡';
    return;
  }

  audio.src=st.url;
  audio.play().catch(()=>alert("Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´ ÛŒØ§ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù…Ø±ÙˆØ±Ú¯Ø±"));

  if(currentButton) currentButton.textContent='â–¶ Ù¾Ø®Ø´';
  btn.textContent='â¸ ØªÙˆÙ‚Ù';

  currentStation=st;
  currentButton=btn;
  nowPlaying.textContent='Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´: '+st.name;
}

volume.oninput=()=> audio.volume=parseFloat(volume.value);
stopBtn.onclick=()=>{
  audio.pause();
  if(currentButton) currentButton.textContent='â–¶ Ù¾Ø®Ø´';
  nowPlaying.textContent='Ù‡ÛŒÚ† Ø±Ø§Ø¯ÛŒÙˆÛŒÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡';
};

/* ==== EQUALIZER ==== */
const eq = document.getElementById('eq');
const ctx = eq.getContext('2d');

function resizeEq(){
  eq.width = window.innerWidth;
  eq.height = 64;
}
resizeEq();
window.addEventListener('resize', resizeEq);

let audioCtx=null, analyser=null, srcNode=null;

function setupEQ(){
  if(audioCtx) return;
  audioCtx = new (window.AudioContext||window.webkitAudioContext)();
  srcNode = audioCtx.createMediaElementSource(audio);
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 256;
  srcNode.connect(analyser);
  analyser.connect(audioCtx.destination);
}

audio.addEventListener("play", ()=> setupEQ());

function eqDraw(){
  requestAnimationFrame(eqDraw);
  if(!analyser){
    ctx.fillStyle="#000";
    ctx.fillRect(0,0,eq.width,eq.height);
    return;
  }

  const bufferLength = analyser.frequencyBinCount;
  const data = new Uint8Array(bufferLength);
  analyser.getByteFrequencyData(data);

  ctx.fillStyle="#000";
  ctx.fillRect(0,0,eq.width,eq.height);

  const barWidth = (eq.width/bufferLength)*2.5;
  let x=0;

  for(let i=0;i<bufferLength;i++){
    let v = data[i] * 0.7;   // **70% max â†’ Ù‡Ù…ÛŒØ´Ù‡ Ú©Ù…ÛŒ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ù„Ø§ÛŒ Ø³ØªÙˆÙ† Ø¨Ù…Ø§Ù†Ø¯**
    ctx.fillStyle="#00ffa6";
    ctx.fillRect(x, eq.height - v, barWidth, v);
    x += barWidth + 1;
  }
}
eqDraw();
</script>

</body>
</html>
