<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Ø±Ø§Ø¯ÛŒÙˆ Ø¢Ù†Ù„Ø§ÛŒÙ†</title>
  <style>
    :root{
      --bg:#121212;
      --card:#1d1d1d;
      --accent:#00ffa6;
      --text:#eee;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      direction:rtl;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .header{
      padding:18px;
      text-align:center;
      background:#151515;
      font-size:22px;
      border-bottom:1px solid rgba(255,255,255,0.03);
    }

    /* layout columns */
    .cols{
      display:flex;
      gap:18px;
      padding:16px;
      box-sizing:border-box;
      max-width:1100px;
      margin: 12px auto 90px auto; /* leave space for player */
    }
    .col{
      flex:1;
      background:transparent;
    }
    .category{
      padding:10px 14px;
      font-size:18px;
      background:#212121;
      border-radius:8px;
      margin-bottom:10px;
    }

    .station-list{display:flex;flex-direction:column;gap:10px}
    .station{
      display:flex;
      align-items:center;
      justify-content:space-between;
      background:var(--card);
      padding:10px;
      border-radius:10px;
      cursor:pointer;
      transition: background .15s;
    }
    .station:hover{background:#2a2a2a}
    .station .left{display:flex;align-items:center;gap:12px}
    .station img{width:44px;height:44px;border-radius:6px;object-fit:cover;flex-shrink:0}
    .station .meta{display:flex;flex-direction:column;text-align:right}
    .station .meta .name{font-weight:600}
    .station button{background:var(--accent);border:none;color:#000;padding:8px 10px;border-radius:8px;cursor:pointer}

        /* eq fixed just above player */
    #eq{
      position:fixed;
      bottom:10px; /* height of player-box approx 56-70px */
      left:0;
      right:0;
      width:70%;
      height:64px;
      display:block;
      background:#000;
      z-index:900;
    }
    /* fixed simple player bottom */
    .player-box{
      position:fixed;
      bottom:0;
      left:0;
      right:0;
      background:#181818;
      border-top:3px solid var(--accent);
      padding:10px 14px;
      display:flex;
      align-items:center;
      gap:12px;
      z-index:1000;
    }
    .player-title{flex:1;font-size:15px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
    .vol{width:140px}



    /* responsive */
    @media(max-width:900px){
      .cols{flex-direction:column;margin-bottom:180px}
      #eq{height:48px; bottom:50px}
    }
  </style>
</head>
<body>

  <div class="header">ğŸ§ Ø±Ø§Ø¯ÛŒÙˆ Ø¢Ù†Ù„Ø§ÛŒÙ†</div>

  <div class="cols">
    <!-- left column: Turk/Azeri -->
    <div class="col">
      <div class="category">ğŸ“Œ ØªØ±Ú©ÛŒ Ùˆ Ø¢Ø°Ø±ÛŒ</div>
      <div class="station-list" id="cat_tr"></div>
    </div>

    <!-- right column: ÙØ§Ø±Ø³ÛŒ -->
    <div class="col">
      <div class="category">ğŸ“Œ ÙØ§Ø±Ø³ÛŒ</div>
      <div class="station-list" id="cat_fa"></div>
    </div>
  </div>

  <!-- player fixed bottom -->
  <div class="player-box" role="region" aria-label="Ù¾Ù„ÛŒØ±">
    <div class="player-title" id="nowPlaying">Ù‡ÛŒÚ† Ø±Ø§Ø¯ÛŒÙˆÛŒÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡</div>

    <div style="display:flex;align-items:center;gap:8px;">
      Ø­Ø¬Ù…:
      <input class="vol" id="volume" type="range" min="0" max="1" step="0.01" value="1" aria-label="Ø­Ø¬Ù… ØµØ¯Ø§">
    </div>

    <div>
      <button id="stopBtn" title="ØªÙˆÙ‚Ù">â¹ ØªÙˆÙ‚Ù</button>
    </div>
  </div>

  <!-- equalizer canvas (fixed) -->
  <canvas id="eq"></canvas>

<script>
/* ==========================
   Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÛŒØ³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§ (Ø§Ø³Ù… + Ø§Ø³ØªØ±ÛŒÙ… + Ø¹Ú©Ø³ + Ø²Ø¨Ø§Ù†)
   ØªÙˆ Ù‚Ø¨Ù„Ø§Ù‹ Ù„ÛŒØ³Øª Ø±Ùˆ ÙØ±Ø³ØªØ§Ø¯ÛŒØ› Ø§ÛŒÙ†Ø¬Ø§ Ù‡Ù…Ø§Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ù‚Ø±Ø§Ø± Ø¯Ø§Ø¯Ù….
   Ø§Ú¯Ø± Ø®ÙˆØ§Ø³ØªÛŒ Ø§Ø¶Ø§ÙÙ‡/Ø­Ø°Ù Ú©Ù†Ù… Ø¨Ú¯Ùˆ.
   ========================== */
const stations = [
  /* ÙØ§Ø±Ø³ÛŒ */
  { name:"Radio Shadi", url:"https://ice9.securenetsystems.net/SHADI", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/NRIGBcOzqWFUZZ4dhVZ3bp6oKMftJTpniyrmgru7dZM/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvOGUyZDcwMjUtMmZhMC00MDU5LWFmNGMtMDg0ZjA1NmZjOTk4L2ltYWdlLz91PTE3MDE2OTc1OTEwMDA.webp" },
  { name:"Radio Avang Klap", url:"https://stream.zeno.fm/fpabqr8pd9zuv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/acnY7ntKys9h-2AhQvRWpVDUV0WY3Kh-Jfb8rkjNuH4/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvNTBmMmVlYjAtNzVkOC00YTllLTlkNWYtZjY1YjkwYjk3MDQ2L2ltYWdlLz91PTE3MzY4NDYwMzEwMDA.webp" },
  { name:"Radio Bamdad", url:"https://stream.zeno.fm/16gxgv7ch5zuv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/RI7ZbLc36B1wt2hmlyMxSBwXpETbKBuvcd6coiCjGds/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlNZ3NTQ2tGMWRHaERiR2xsYm5RWWdJQ1FvLTdyMGdvTUN4SU9VM1JoZEdsdmJsQnliMlpwYkdVWWdJQ1E0OGEwaUFnTW9nRUVlbVZ1YncvaW1hZ2UvP3U9MTY2MDgzMzA4MjAwMA.webp" },
  { name:"Radio Simorgh", url:"https://stream.zeno.fm/9svfnobkrxrvv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/eNYSMBmJNoW6_hcdkosiReSKOx7HHLAn7fP6Tso3DWc/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvMjAxZGE3MmItNWFhYy00OWU5LWEzN2YtM2IzYjZjZjZmZjQxL2ltYWdlLz91PTE3NjMxNjAxMzcwMDA.webp" },
  { name:"Radio Hamrah", url:"https://stream.zeno.fm/euutwhsru2wtv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/QXH8sr3xE8WGEbYBpaNlPpoAuEMKqcEoFDAZOS_fixI/rs:fill:256:256/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlHd3NTRGxOMFlYUnBiMjVRY205bWFXeGxHSUNBZ0lEUDd0b0tES0lCQkhwbGJtOC9pbWFnZS8_dT0xNjcyMzAxMjY3MDAw.webp" },
  { name:"Radio Yar", url:"https://stream.zeno.fm/oyb5oh6ne3tuv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/kw4YYJRvsl-DswchOsWr3Vtz1MnLY8gfkPAf_FSMgyo/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvMWRjZmJjMzktYzM4NS00OTg3LWE5ZTQtYTFiMjE0NDAzZDg3L2ltYWdlLz91PTE3MjgzOTk2MzcwMDA.webp" },
  { name:"Radio Yar Plus", url:"https://stream.zeno.fm/2jwyo983y49vv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/7XCVsr_ZE1q3fpPcrCpQD1prYmMrjHoCWo2u7sHhGYU/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvZDYxZWM4ZjMtZTI1NC00ODBmLWE1NzAtNTZhNjYxYjY0ZTllL2ltYWdlLz91PTE3MzgxNTc4NTMwMDA.webp" },
  { name:"KIRN 670 AM", url:"https://stream.zeno.fm/wyth8w2r3heuv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/YJygcpY0wJ-ORl7yrs57txbWABe87n5INuAERhqfRXk/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlNZ3NTQ2tGMWRHaERiR2xsYm5RWWdJQ0F0NWZQcWdvTUN4SU9VM1JoZEdsdmJsQnliMlpwYkdVWWdJQ0F3TW00akFvTW9nRUVlbVZ1YncvaW1hZ2UvP3U9MTY2MTI4MjY5MzAwMA.webp" },
  { name:"Radio Farsi London", url:"https://stream.zeno.fm/c3kkavhhzd0uv", lang:"fa",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/-YxtmG_1FTNyGCT_8g7soWRiEMvzx7HNLWvs57CcbIw/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlNZ3NTQ2tGMWRHaERiR2xsYm5RWWdJREFqUHZXa0FnTUN4SU9VM1JoZEdsdmJsQnliMlpwYkdVWWdJRFEybzJKdVFvTW9nRUVlbVZ1YncvaW1hZ2UvP3U9MTY3ODA2MTQ1MDAwMA.webp" },

  /* ØªØ±Ú©/Ø¢Ø°Ø±ÛŒ */
  { name:"Arabesk Efsane FM", url:"https://stream.zeno.fm/x5n4sfyy9nhvv", lang:"tr",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/6PGFwWVgLll3f4INzxVqlwdjpOfStwE2wVTFu6GDrzw/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlNZ3NTQ2tGMWRHaERiR2xsYm5RWWdJQ0l6YVR3dndnTUN4SU9VM1JoZEdsdmJsQnliMlpwYkdVWWdJQ0lfYi1XNFFrTW9nRUVlbVZ1YncvaW1hZ2UvP3U9MTY4NTE3MjE5NTAwMA.webp" },
  { name:"Radyo Nostalji", url:"https://stream.zeno.fm/q7zxyx2qsfhvv", lang:"tr",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/C40EP-w5lbCEjhD3OEXoLH0mqT4QAjoi3HcMlrdprM0/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlNZ3NTQ2tGMWRHaERiR2xsYm5RWWdJQ0F4SkdkdkFzTUN4SU9VM1JoZEdsdmJsQnliMlpwYkdVWWdJQ0k2b3FmX3drTW9nRUVlbVZ1YncvaW1hZ2UvP3U9MTY4NjQ5NTUzMzAwMA.webp" },
  { name:"Radio Veten", url:"https://stream.zeno.fm/0kgkkzanmueuv", lang:"tr",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/8g8PctmUYIp-MsAb60n1yzr6UB2mIagYYh9OFcI8AO4/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvYWd4emZucGxibTh0YzNSaGRITnlNZ3NTQ2tGMWRHaERiR2xsYm5RWWdJREFwdENqdkFzTUN4SU9VM1JoZEdsdmJsQnliMlpwYkdVWWdJQ0FnSUR5aUFvTW9nRUVlbVZ1YncvaW1hZ2UvP3U9MTY3NDE5MDEyNzAwMA.webp" },
  { name:"Ä°znik FM", url:"https://stream.zeno.fm/4crdx4nukrnuv", lang:"tr",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/cbY5lyYrOd6Dy6Dor1DhLsqTzzfB4I8-0dwyooRgQa4/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvNzkwYTBjYjctYTMwMC00ODRjLWI2ZjItMTg5YmNjOWFjNmM1L2ltYWdlLz91PTE3NjI2ODg4ODIwMDA.webp" },
  { name:"NaxÃ§Ä±van Radiosu", url:"http://s33.myradiostream.com:12782/listen.mp3", lang:"tr",
    logo:"https://zeno.fm/_ipx/_/https://images.zeno.fm/qpsO_iNA8aGqsKrXHX0fUneE_f0gUl1kqYwilPn2HD4/rs:fill:288:288/g:ce:0:0/aHR0cHM6Ly9wcm94eS56ZW5vLmZtL2NvbnRlbnQvc3RhdGlvbnMvMjlmNzI0NTEtOWM2Ny00YzgxLWE0MTMtMWFlODJjYTM2ZWY4L2ltYWdlLz91PTE3MDE2OTY4MDYwMDA.webp" }
];


/* ========= create UI items ========= */
const cat_fa = document.getElementById('cat_fa');
const cat_tr = document.getElementById('cat_tr');
const nowPlaying = document.getElementById('nowPlaying');
const volume = document.getElementById('volume');
const stopBtn = document.getElementById('stopBtn');

const audio = new Audio();
audio.crossOrigin = "anonymous";
audio.preload = "none";
audio.volume = parseFloat(volume.value);

/* build station element */
function makeStationElement(st){
  const el = document.createElement('div');
  el.className = 'station';

  const left = document.createElement('div'); left.className='left';
  const meta = document.createElement('div'); meta.className='meta';
  const title = document.createElement('div'); title.className='name'; title.textContent = st.name;
  meta.appendChild(title);

  if(st.logo){
    const img = document.createElement('img'); img.src = st.logo; img.alt = st.name;
    // hide if load fails
    img.onerror = ()=>{ img.style.display='none' };
    left.appendChild(img);
  }
  left.appendChild(meta);

  const btn = document.createElement('button');
  btn.textContent = 'â–¶ Ù¾Ø®Ø´';
  btn.onclick = (e)=>{ e.stopPropagation(); handlePlay(st, btn); };

  el.appendChild(left);
  el.appendChild(btn);

  el.onclick = ()=> handlePlay(st, btn);
  return el;
}

/* render lists */
stations.forEach(s=>{
  const node = makeStationElement(s);
  if(s.lang === 'fa') cat_fa.appendChild(node);
  else cat_tr.appendChild(node);
});

/* playback management */
let currentStation = null;
let currentButton = null;

function handlePlay(st, btn){
  // if same and playing -> pause
  if(currentStation && currentStation.url === st.url && !audio.paused){
    audio.pause();
    btn.textContent = 'â–¶ Ù¾Ø®Ø´';
    nowPlaying.textContent = 'Ù‡ÛŒÚ† Ø±Ø§Ø¯ÛŒÙˆÛŒÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡';
    return;
  }

  // new station: set src and play
  audio.src = st.url;
  audio.play().catch(err=>{
    console.warn('play failed:', err);
    alert('Ù¾Ø®Ø´ Ù†Ø§Ù…ÙˆÙÙ‚: Ù…Ø±ÙˆØ±Ú¯Ø± ÛŒØ§ Ù„ÛŒÙ†Ú© Ø§Ø³ØªØ±ÛŒÙ… Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ø¯. ÛŒÚ©Ø¨Ø§Ø± Ø±ÙˆÛŒ ØµÙØ­Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ Ø§Ø¬Ø§Ø²Ù‡Ù” Ù¾Ø®Ø´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯ ÛŒØ§ Ù„ÛŒÙ†Ú© Ø±Ø§ Ú†Ú© Ú©Ù†.');
  });

  if(currentButton) currentButton.textContent = 'â–¶ Ù¾Ø®Ø´';
  btn.textContent = 'â¸ï¸ ØªÙˆÙ‚Ù';
  currentStation = st;
  currentButton = btn;
  nowPlaying.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´: ' + st.name;
}

/* controls */
volume.addEventListener('input', ()=>{ audio.volume = parseFloat(volume.value); });
stopBtn.addEventListener('click', ()=>{
  audio.pause();
  if(currentButton) currentButton.textContent = 'â–¶ Ù¾Ø®Ø´';
  nowPlaying.textContent = 'Ù‡ÛŒÚ† Ø±Ø§Ø¯ÛŒÙˆÛŒÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡';
});

/* ============ Equalizer (WebAudio) ============ */
const eq = document.getElementById('eq');
const eqCtx = eq.getContext('2d');

function resizeEq(){
  // make canvas full width
  eq.width = window.innerWidth;
  // keep height from CSS (64) but ensure devicePixelRatio for sharpness
  const cssH = parseInt(getComputedStyle(eq).height) || 64;
  const dpr = window.devicePixelRatio || 1;
  eq.width = Math.floor(window.innerWidth * dpr);
  eq.height = cssH * dpr;
  eq.style.width = '100%';
  eq.style.height = cssH + 'px';
  eqCtx.setTransform(dpr,0,0,dpr,0,0); // scale drawing to CSS pixels
}
window.addEventListener('resize', resizeEq);
resizeEq();

let audioCtx = null, analyser = null, srcNode = null;
function ensureAudioContext(){
  if(audioCtx) return;
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  srcNode = audioCtx.createMediaElementSource(audio);
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 256;
  srcNode.connect(analyser);
  analyser.connect(audioCtx.destination);
}

/* draw loop with ceiling (maxDisplayFrac) to avoid full bars */
const maxDisplayFrac = 0.70; // 70% ceiling as requested

function draw(){
  requestAnimationFrame(draw);

  if(!analyser){
    // clear
    eqCtx.fillStyle = '#000';
    eqCtx.fillRect(0,0,eq.width,eq.height);
    return;
  }

  const bufferLength = analyser.frequencyBinCount;
  const dataArray = new Uint8Array(bufferLength);
  analyser.getByteFrequencyData(dataArray);

  // clear (use CSS px sizes; ctx transform handles DPR)
  const cssW = eq.clientWidth;
  const cssH = eq.clientHeight;
  eqCtx.fillStyle = '#000';
  eqCtx.fillRect(0,0,cssW,cssH);

  // bar layout
  const barWidth = (cssW / bufferLength) * 2.2; // spacing factor
  let x = 0;

  for(let i=0;i<bufferLength;i++){
    // raw 0..255
    let raw = dataArray[i] / 255;      // 0..1
    // apply ceiling: scale down so maximum maps to maxDisplayFrac
    let scaled = Math.min(raw, 1.0) * maxDisplayFrac; // 0..maxDisplayFrac
    // convert to pixels (use css height)
    let v = scaled * cssH;

    // slight smoothing/decay could be added if wanted (not fake jumping)
    // draw
    eqCtx.fillStyle = '#00ffa6';
    // draw rounded-ish bars by drawing rects (simple)
    eqCtx.fillRect(x, cssH - v, barWidth, v);

    x += barWidth + 1;
  }
}
draw();

// create AudioContext on first user-initiated play (many browsers require)
audio.addEventListener('play', ()=>{
  try{ ensureAudioContext(); }catch(e){ console.warn(e) }
});
</script>
</body>
</html>
